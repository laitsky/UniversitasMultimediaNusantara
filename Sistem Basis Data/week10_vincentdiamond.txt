#1
CREATE VIEW service_and_total 
AS
(SELECT o.orderID AS 'Order ID',
	date_format(o.orderdate, '%d %M %y') AS Date,
	s.servicedesc AS 'Service Type', s.price AS Services,
	SUM(od.qty*od.price+s.price) as Total)
FROM
	ORDERS O
INNER JOIN 
	servicedetails SD on o.orderid = sd.orderid
INNER JOIN
	services s on sd.serviceid = s.serviceid
INNER JOIN
	orderdetails od on o.orderid = od.orderid
GROUP BY o.orderid;

SELECT * FROM service_and_total

#2
CREATE VIEW sales_by_year_month
AS
(SELECT DATE_FORMAT(o.orderdate, '%Y') as Year,
	DATE_FORMAT(o.orderdate, '%M') as Month,
	COUNT(o.orderid) as 'Jumlah Transaksi',
	CONCAT('Rp.', SUM(od.price*od.qty), ',-') as Sales)
FROM ORDERS O
INNER JOIN orderdetails od on o.orderid = od.orderid
GROUP BY date_format(o.orderdate, '%M')
ORDER BY o.orderdate;

